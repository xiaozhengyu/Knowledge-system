# 加密数据与模糊查询

>   原文地址：https://ningyu1.github.io/20201230/encrypted-data-fuzzy-query.html



项目中经常会遇到一些敏感数据，例如，手机号、身份证号、住址、银行卡号。对于这类敏感信息，如果直接使用明文存储是十分危险的，通常会先对数据进行加密，再将密文存储到数据库。然后，新的问题又来了——如何对加密后的数据进行模糊查询。



[TOC]



## 沙雕方案

方案1：先将所有数据加载进内存进行解密，然后对解密后的数据进行模糊匹配

>   分析：如果数据量很小，可以考虑这种方案；如果数据量很大，完全没法用



方案2：~~创建一个 【明文->密文】 映射表，先到映射表进行模糊匹配，然后在根据匹配结果到数据库检索数据~~

>   分析：？？？那我们为什么还要对数据进行加密



## 常规方案

方案1：在数据库实现对应的解密算法，修改模糊查询条件——先调用解密算法对数据进行解密，然后进行模糊匹配。

>   -   优点：实现成本低，使用成本低（只需要对遗忘的模糊查找进行略微修改即可）
>   -   缺点：有些数据库没法实现解密算法；没法利用索引对查询进行优化
>
>   分析：本方案跟“沙雕方案1”很像，只不过将处理数据的压力转移给了数据库。



方案2：
