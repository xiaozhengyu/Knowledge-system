# 弹性伸缩



参考文章：

-   [阿里云-什么是弹性伸缩Auto Scaling](https://help.aliyun.com/document_detail/25857.html)
-   [阿里云-弹性伸缩部署](https://developer.aliyun.com/article/4226)
-   [SpringCloud 应用在 Kubernetes 上的最佳实践 —— 高可用（弹性伸缩）](https://developer.aliyun.com/article/775329?utm_content=g_1000189184)



## 前言

弹性伸缩是一种为了满足业务需求、保证服务质量、平衡服务成本的重要应用管理策略。弹性伸缩让应用的部署规模能够根据实时的业务量产生动态调整，在业务高峰期扩大部署规模，保证服务不被业务冲垮；在业务低谷期缩减部署规模，避免资源浪费。

由于大部分云资源是按需取用，按量计费模式，相比使用 IDC，使用云的用户从弹性伸缩获得的成本优势是非常明显的，弹性伸缩也是大多数云上用户的选择。

有两种实现弹性伸缩方法，一种是“**垂直弹性**”，即“Scale Up”，另一种是“**水平弹性**”，也就是“Scale Out”。

### 1. 垂直伸缩（Scale up）

垂直弹性伸缩一般是指通过升降<mark>服务器的规格</mark>来实现的弹性伸缩。这种伸缩方式对应用本身几乎没有约束，可以被大部分应用或组件使用，它的问题主要在两个方面：

-   动态调整服务器的规格而不影响上层部署的应用，对基础设施要求比较高，对于许多云厂商而言是个难题，并不能实现业务完全无感的动态变配
-   垂直弹性无法突破单台物理设备的规格限制，面向巨量的突发业务增长，<font color = red>垂直弹性的应对能力是有上限的</font>

### 2. 水平伸缩（Scale out）

水平弹性伸缩依靠增减<mark>服务器的数量</mark>来实现弹性伸缩，对基础设施的要求不高，水平弹性除了可以解决容量上限的问题，多副本部署还能带来更高的可靠性，因为被广泛的使用在生产系统中，很多时候水平弹性也成了弹性伸缩的代名词。



## 微服务与弹性伸缩

水平弹性虽然存在诸多优势，但它<font color = red>对于应用本身的要求相比垂直弹性是更高的</font>，开发者在使用前需要要考虑好以下的问题：

-   多副本部署要求应用本身无状态化，如何抽离应用中的状态信息并保持配置同步？
-   弹性伸缩导致应用实例本身是不稳定的，如何保证应用实例之间能实现可靠的相互调用？

这些恰好也是微服务架构要解决的问题，而 SpringCloud 作为广泛使用的微服务框架自然不例外，拿问题对号入座的来看：

-   其一，通过 SpringCloud，开发者可以将原先单体应用中无状态的部分拆解出来，以服务的形式来组织业务逻辑，无状态的服务本身是可以进行水平伸缩的，另外 SpringCloud 提供了很易用的集中式配置管理能力，确保了配置信息可以被高效的分发和同步
-   其二，SpringCloud 的服务注册和发现机制，使得服务可以动态的增加或移除实例，通过熔断等服务治理机制可以进一步提升远程调用的可靠性

换个角度看，催生微服务的驱动力之一，就是开发者希望利用云的弹性伸缩能力来实现运营成本和服务质量的平衡，因此微服务从设计上就考虑到了要利用弹性伸缩的能力，它们之间是本来就是相辅相成，紧密相关的。